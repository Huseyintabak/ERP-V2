---
alwaysApply: true
---

# ğŸš€ Thunder ERP - CanlÄ± Ortam GeliÅŸtirme KurallarÄ±

**âš ï¸ KRÄ°TÄ°K UYARI: Bu proje artÄ±k CANLI ORTAMDA Ã§alÄ±ÅŸÄ±yor!**

## ğŸ›¡ï¸ TEMEL GÃœVENLÄ°K KURALLARI

### 1. **VERÄ° KORUMA** ğŸ”’
```bash
âŒ ASLA YAPMA:
- CanlÄ± veriyi silme
- Mevcut tablolarÄ± DROP etme
- Kritik verileri gÃ¼ncelleme
- Bulk DELETE iÅŸlemleri

âœ… GÃœVENLÄ° YAKLAÅIM:
- Soft delete kullan
- Backup al
- Test ortamÄ±nda dene
- Rollback planÄ± hazÄ±rla
```

### 2. **DATABASE DEÄÄ°ÅÄ°KLÄ°KLERÄ°** ğŸ—„ï¸
```sql
âŒ TEHLÄ°KELÄ°:
DROP TABLE users;
ALTER TABLE orders DROP COLUMN customer_id;
DELETE FROM stock_movements;

âœ… GÃœVENLÄ°:
-- Migration ile yeni kolon ekle
ALTER TABLE orders ADD COLUMN new_field VARCHAR(255) DEFAULT '';
-- Soft delete
UPDATE orders SET is_deleted = true WHERE id = ?;
-- Backup ile gÃ¼ncelleme
UPDATE stock_movements SET status = 'archived' WHERE created_at < ?;
```

### 3. **API DEÄÄ°ÅÄ°KLÄ°KLERÄ°** ğŸ”Œ
```typescript
âŒ BREAKING CHANGES:
// Mevcut endpoint'i deÄŸiÅŸtirme
GET /api/orders â†’ POST /api/orders

âœ… BACKWARD COMPATIBILITY:
// Yeni versiyon ekle
GET /api/v2/orders
// Mevcut endpoint'i koru
GET /api/orders (deprecated)
```

## ğŸ“Š CANLI VERÄ° KORUMA LÄ°STESÄ°

### **Kritik Tablolar** âš ï¸
```sql
-- ASLA SÄ°LME/GÃœNCELLEME YAPMA:
users                    -- KullanÄ±cÄ± hesaplarÄ±
customers               -- MÃ¼ÅŸteri verileri
orders                  -- SipariÅŸ geÃ§miÅŸi
order_items             -- SipariÅŸ kalemleri
raw_materials           -- Hammadde stoklarÄ±
semi_finished_products  -- YarÄ± mamul stoklarÄ±
finished_products       -- Nihai Ã¼rÃ¼n stoklarÄ±
stock_movements         -- Stok hareketleri
audit_logs              -- Audit kayÄ±tlarÄ±
price_history           -- Fiyat geÃ§miÅŸi
zone_inventories        -- Depo zone stoklarÄ±
```

### **GÃ¼venli Ä°ÅŸlemler** âœ…
```sql
-- Bu iÅŸlemler gÃ¼venli:
INSERT INTO new_table...     -- Yeni kayÄ±t ekleme
UPDATE status = 'active'     -- Status gÃ¼ncelleme
SELECT ...                   -- Veri okuma
CREATE INDEX ...             -- Index ekleme
```

## ğŸ” CODE REVIEW CHECKLIST

### **Her PR'da Kontrol Et** âœ…
- [ ] **Breaking Change:** Mevcut API'ler bozuldu mu?
- [ ] **Data Safety:** CanlÄ± veri etkileniyor mu?
- [ ] **Error Handling:** Hata durumlarÄ± handle ediliyor mu?
- [ ] **Logging:** Ã–nemli iÅŸlemler loglanÄ±yor mu?
- [ ] **Performance:** Query'ler optimize mi?
- [ ] **Security:** SQL injection korumasÄ± var mÄ±?
- [ ] **Rollback:** Geri alma planÄ± hazÄ±r mÄ±?
- [ ] **Testing:** Test coverage yeterli mi?

### **Red Flags** ğŸš©
```typescript
// Bu pattern'larÄ± ASLA kullanma:
DELETE FROM users;                    // Bulk delete
DROP TABLE orders;                   // Table drop
ALTER TABLE DROP COLUMN;             // Column drop
UPDATE * SET field = value;          // Bulk update
eval(userInput);                     // Code injection
```

## ğŸš¨ ACÄ°L DURUM PROSEDÃœRÃœ

### **Sistem Ã‡Ã¶ktÃ¼ÄŸÃ¼nde** ğŸ’¥
```bash
# 1. HÄ±zlÄ± rollback
git revert <commit-hash>
npm run deploy:rollback

# 2. Database restore
psql thunder_erp < backup_latest.sql

# 3. Servisleri yeniden baÅŸlat
pm2 restart all

# 4. Monitor et
pm2 logs
```

## âš¡ HIZLI REFERANS

### **GÃ¼venli Komutlar** âœ…
```bash
# Backup
pg_dump thunder_erp > backup.sql

# Migration
npx supabase migration up

# Deploy
npm run build && npm run deploy

# Rollback
git revert HEAD && npm run deploy
```

### **Tehlikeli Komutlar** âŒ
```bash
# ASLA Ã‡ALIÅTIRMA:
DROP DATABASE thunder_erp;
rm -rf /var/www/thunder-erp;
killall node;
```

## ğŸ¯ HEDEF
**SÄ±fÄ±r downtime, sÄ±fÄ±r veri kaybÄ±, maksimum gÃ¼venlik!**

---

**ğŸ“… Son GÃ¼ncelleme:** 2025-01-27  
**ğŸ”„ Versiyon:** 1.0.0 Production Ready
